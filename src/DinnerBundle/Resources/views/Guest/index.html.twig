{% extends 'base.html.twig' %}

{% import '@Dinner/Common/numeric.html.twig' as numeric %}

{% block title %}Guests | {{ parent() }}{% endblock %}

{% block body %}
    <h1>Guests list</h1>

    <table class="summary">
        <tr>
            <th>Total pledges</th>
            <td class="numeric">{{ totals.pledgeCurrent }}</td>
        </tr>
        <tr>
            <th>Total paid</th>
            <td class="numeric">{{ totals.paid }}</td>
        </tr>
        <tr>
            <th>Balance</th>
            <td class="numeric">{{ totals.balance }}</td>
        </tr>
        <tr>
            <th>Total seats</th>
            <td class="numeric">{{ totals.totalSeats }}</td>
        </tr>
        <tr>
            <th>Paid seats</th>
            <td class="numeric">{{ totals.paidSeats }}</td>
        </tr>
    </table>

    <nav>
        <div><a href="{{ path('guest_new') }}">Create a new guest</a></div>
    </nav>

    <table class="index">
        <thead>
            <tr>
                <th>Family</th>
                <th>Him
                <th>Her</th>
                <th>Do not call
                <th>City</th>
                <th>Phone</th>
                <th>Mobile</th>
                <th>2013</th>
                <th>2014</th>
                <th>2015</th>
                <th>Pledged</th>
                <th>Paid</th>
                <th>Balance</th>
                <th>Seats</th>
                <th>Affiliation</th>
            </tr>
        </thead>
        <tbody>
        {% for guest in guests %}
            <tr>
                <td><a href="{{ path('guest_edit', { 'id': guest.id }) }}">{{ guest.familyName }}</a></td>
                <td>{{ guest.hisName }}</td>
                <td>{{ guest.herName }}</td>
                <td>{% if guest.doNotCall %}NOT{% endif %}</td>
                <td>{{ guest.city }}</td>
                <td>{{ guest.phone }}</td>
                <td>{{ guest.mobile }}</td>
                <td class="numeric">{{ numeric.currency(guest.pledge2013) }}</td>
                <td class="numeric">{{ numeric.currency(guest.pledge2014) }}</td>

                {% if guest.pledgeIsLow %}
                    <td class="numeric alert">{{ numeric.currency(guest.pledgePrevious) }} </td>
                {% else %}
                    <td class="numeric">{{ numeric.currency(guest.pledgePrevious) }} </td>
                {% endif %}

                {% if guest.pledgeIsLow or not guest.pledgeIsPaid %}
                    <td class="numeric alert">{{ numeric.currency(guest.pledgeCurrent) }} </td>
                {% else %}
                    <td class="numeric">{{ numeric.currency(guest.pledgeCurrent) }} </td>
                {% endif %}

                <td class="numeric">{{ numeric.currency(guest.paid) }} </td>

                {% if not guest.pledgeIsPaid %}
                    <td class="numeric alert">{{ numeric.currency(guest.balance) }} </td>
                {% else %}
                    <td class="numeric">{{ numeric.currency(guest.balance) }} </td>
                {% endif %}

                <td class="numeric">{{ guest.totalSeats }}</td>
                <td>{{ guest.honoreeString }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <nav>
        <div><a href="{{ path('guest_new') }}">Create a new guest</a></div>
    </nav>
{% endblock %}
